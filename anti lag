local Workspace = workspace
local SWEEP_INTERVAL = 6        -- cada 6 segundos en lugar de cada 1
local CHUNK_SIZE = 250          -- cuantos objetos procesar por frame

local function fullSweep()
    local all = Workspace:GetDescendants()
    local n = #all
    local i = 1

    while i <= n do
        local upper = math.min(i + CHUNK_SIZE - 1, n)
        for j = i, upper do
            local obj = all[j]
            if obj and obj.Parent then
                -- tu lógica aquí, pero sin pcall innecesarios
                -- ejemplo:
                if obj:IsA("ParticleEmitter") then
                    obj.Enabled = false
                elseif obj:IsA("BasePart") then
                    obj.Material = Enum.Material.Plastic
                    obj.CastShadow = false
                end
            end
        end
        task.wait() -- cede el frame aquí
        i = upper + 1
    end
end

task.spawn(function()
    while _G.Internal and _G.Internal.MainAlive do
        if _G.State and _G.State.LagCleanerEnabled then
            fullSweep()
        end
        task.wait(SWEEP_INTERVAL)
    end
end)
