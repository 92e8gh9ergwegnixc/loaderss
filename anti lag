-- lagcleaner_instant_force.lua
-- Ejecuta TODO de una sola vez, sin toggle, sin loop

local Workspace = workspace
local string_lower = string.lower
local pcall = pcall

-- palabras clave para eliminar objetos con nombres de dinero
local NAME_KEYWORDS = { "money", "cash", "coin", "moneda", "monedas", "dinero" }

-- checks
local function isEffectInstance(inst)
    if not inst then return false end
    if inst:IsA("ParticleEmitter") or inst:IsA("Trail") or inst:IsA("Beam")
    or inst:IsA("Sparkles") or inst:IsA("Fire") or inst:IsA("Smoke") then
        return true
    end
    if inst:IsA("PointLight") or inst:IsA("SurfaceLight") or inst:IsA("SpotLight") then
        return true
    end
    return false
end

local function nameLooksLikeMoney(name)
    if not name or name == "" then return false end
    local n = string_lower(tostring(name))
    for _, kw in ipairs(NAME_KEYWORDS) do
        if n:find(kw, 1, true) then return true end
    end
    return false
end

-- simplificar partes
local function simplifyPart(part)
    if not part or not part:IsA("BasePart") then return end
    pcall(function()
        part.Material = Enum.Material.Plastic
        part.CastShadow = false
        part.Reflectance = 0
        for _, child in ipairs(part:GetChildren()) do
            if child:IsA("Decal") or child:IsA("Texture") then
                child.Texture = ""
            elseif child:IsA("SurfaceAppearance") then
                child:Destroy()
            end
        end
    end)
end

-- procesar cada objeto
local function handleInstance(inst)
    if not inst then return end

    -- eliminar si el nombre parece dinero
    if nameLooksLikeMoney(inst.Name) then
        pcall(function() inst:Destroy() end)
        return
    end

    -- eliminar/inhabilitar efectos visuales
    if isEffectInstance(inst) then
        pcall(function()
            if inst:IsA("ParticleEmitter") then inst.Enabled = false
            elseif inst:IsA("Trail") or inst:IsA("Beam") or inst:IsA("Fire") or inst:IsA("Smoke") then
                inst:Destroy()
            elseif inst:IsA("Sparkles") then inst.Enabled = false
            elseif inst:IsA("PointLight") or inst:IsA("SurfaceLight") or inst:IsA("SpotLight") then
                inst.Enabled = false
            end
        end)
        return
    end

    -- simplificar materiales/texturas
    if inst:IsA("BasePart") then
        simplifyPart(inst)
    elseif inst:IsA("Decal") or inst:IsA("Texture") then
        pcall(function() inst.Texture = "" end)
    elseif inst:IsA("SurfaceAppearance") then
        pcall(function() inst:Destroy() end)
    end
end

-- ðŸš€ Ejecutar TODO en una sola pasada
for _, obj in ipairs(Workspace:GetDescendants()) do
    handleInstance(obj)
end

print("[LagCleaner] Mapa simplificado instantÃ¡neamente.")
